{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "41a30f6c_06b898ba",
        "filename": "src/find_cb.c",
        "patchSetId": 7
      },
      "lineNbr": 165,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2022-05-17T12:27:27Z",
      "side": 1,
      "message": "if this moves str2predicate/str2action should also move? I assume the point is that you\u0027ll be adding actions for lustre?\n\nIt\u0027s a bit ugly but I\u0027m tempted to say adding actions globally and just saying ENOTSUPP when it\u0027s not handled in action switch is probably just as good...\n\n\n\nas a side note, I really dislike having this code duplicated, having str2predicate return PRED_INVALID or something and calling it preemptively might be ever so slightly less efficient but would avoid lots of potential confusion if we get this wrong when updating...",
      "revId": "f30d43c900268c538d95b991eb67bd2d691cb358",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "34087942_067c2ad1",
        "filename": "src/find_cb.c",
        "patchSetId": 7
      },
      "lineNbr": 165,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2022-05-17T13:17:43Z",
      "side": 1,
      "message": "Indeed we plan on adding actions for Lustre. So yes, I should just move str2action and str2predicate here directly. \n\nHowever, I do not understand what you mean by \"adding actions globally\" ? You mean that the actions we want to add for Lustre should be added to rbh-find directly ?\n\n\nFor the side note, I also agree, but it\u0027s also a larger issue because of the other functions in rbh-find that exit the program, forcing rbh-find functions to be the last called in the overload chain.",
      "parentUuid": "41a30f6c_06b898ba",
      "revId": "f30d43c900268c538d95b991eb67bd2d691cb358",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3846dfb7_20f5998b",
        "filename": "src/find_cb.c",
        "patchSetId": 7
      },
      "lineNbr": 165,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2022-05-17T13:38:02Z",
      "side": 1,
      "message": "\u003e For the side note, I also agree, but it\u0027s also a larger issue because of the other functions in rbh-find that exit the program, forcing rbh-find functions to be the last called in the overload chain.\n\nI don\u0027t think it\u0027d be that big of a change to have these not exit on error if we want to use them that way?\nstr2action and str2predicate in particular are called exactly once, so there\u0027s only one place that would need to check abort if they returned XYZ_INVAL -- or if that sounds painful adding a parameter \"bool abort\" to decide what to do on error could also work.\n\nFor a simple program exit-as-soon-as-error makes sense, but if it\u0027s going to be \"lib-ified\" then I think other problematic functions could also be updated... but would need to look at these on a case by case basis when changing one feels useful.",
      "revId": "f30d43c900268c538d95b991eb67bd2d691cb358",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3a0c2072_0a2f5a37",
        "filename": "src/find_cb.c",
        "patchSetId": 7
      },
      "lineNbr": 165,
      "author": {
        "id": 1003556
      },
      "writtenOn": "2022-05-17T13:38:02Z",
      "side": 1,
      "message": "(splitting notes)\n\u003e However, I do not understand what you mean by \"adding actions globally\" ? You mean that the actions we want to add for Lustre should be added to rbh-find directly ?\n\nYes, we could just not move this (keep CLI parsing in common code) and add lustre actions directly there; non-lustre find would just fail if the options were given there because it\u0027s not listed in the various switches.\n\nThat being said, I\u0027m not seriously believing we\u0027d do this...",
      "parentUuid": "34087942_067c2ad1",
      "revId": "f30d43c900268c538d95b991eb67bd2d691cb358",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ac42c49b_4688fc06",
        "filename": "src/find_cb.c",
        "patchSetId": 7
      },
      "lineNbr": 165,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2022-05-17T13:46:47Z",
      "side": 1,
      "message": "We are thinking of other approaches to this (for instance, having Lustre/SE Linux/others as modules that can be added to rbh-find, and dissociating the tool rbh-find from the module rbh-find). However, we went and chose to implement overloads like this, with multiple callbacks specified.",
      "parentUuid": "3a0c2072_0a2f5a37",
      "revId": "f30d43c900268c538d95b991eb67bd2d691cb358",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4b505409_9421d783",
        "filename": "src/find_cb.c",
        "patchSetId": 7
      },
      "lineNbr": 165,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2022-05-17T13:46:47Z",
      "side": 1,
      "message": "Yes I\u0027m not saying it\u0027s hard, I\u0027m saying it\u0027s not the initial philosophy of the tool, so while we could just change it for the parsing part, why not also change it for the other parts (like the action management for instance).\n\nCurrently, for the Lustre overload, we have an overload of \"find_parse_predicate\" that will just check for Lustre specific predicates, and if not found, will call the base \"find_parse_predicate\" function. So yes, we do have 2 parsing, but since we\u0027re currently dealing with just a few predicates, it\u0027s not that much overall.",
      "parentUuid": "3846dfb7_20f5998b",
      "revId": "f30d43c900268c538d95b991eb67bd2d691cb358",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "18bcefde_dfa9c009",
        "filename": "src/find_cb.c",
        "patchSetId": 7
      },
      "lineNbr": 165,
      "author": {
        "id": 1019048
      },
      "writtenOn": "2022-05-17T15:05:46Z",
      "side": 1,
      "message": "After remembering how we implemented the Lustre rbh-find, we decided not to overload str2predicate because we overload the function just above (which calls it AND calls the appropriate filter creation function), and for str2action, we don\u0027t have another action yet. So we decided that we\u0027ll cross that bridge when necessary, which it isn\u0027t for now.\n\nAlso, there are issues with the fact that both str2action and str2predicate use a specific enum, meaning we have to use an int on our side, or change rbh-find to only use ints, and keep the enum just for \"information\" sake. But it\u0027s not decided yet.\n\nSorry for not being clear in my other responses :(",
      "parentUuid": "4b505409_9421d783",
      "revId": "f30d43c900268c538d95b991eb67bd2d691cb358",
      "serverId": "d5d70762-12d0-45a1-890d-524b12d3f735"
    }
  ]
}